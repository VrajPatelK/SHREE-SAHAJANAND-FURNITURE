<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        SSF - My Reviews
    </title>
    <%- include ('../../partials/header-links') %>

        <script>

            display_reviews(); // calling ...

            function display_reviews() { //declare ...
                $(document).ready(() => {

                    getOrders = new Promise((resolve, reject) => {
                        $.get('/get-reviews', (data, status) => {
                            ;
                            let reviews = data.reviews;

                            let html = "";
                            if (reviews.length === 0) {
                                html =
                                    `<p class="py-2" style="color: #1A120B; text-align: center; background: #E5E5CB;">
                                        You have not add any review yet.
                                    </p>`;
                            }
                            reviews.forEach(review => {
                                let stars = "";
                                for (let i = 1; i <= 5; i++) {
                                    if (i <= review.star)
                                        stars += `<i class="fa-solid text-warning fa-star mx-1"></i>`;
                                    else
                                        stars += `<i class="fa-regular text-warning fa-star mx-1"></i>`;
                                }

                                html +=
                                    `<div class="col-xl-3 col-lg-4 col-md-6 col-12 mb-4 d-flex justify-content-center align-items-center fav-card-div">
                                        <div class="card" style="width: 18rem;">
                                            <img src="${review.product.image}" class="card-img-top" alt="..." style="height:15rem"";>
                                            <div class="card-header">
                                                <p class="card-text d-flex justify-content-between align-item-center">
                                                    <span class="badge bg-white" style="font-size: .9rem;">
                                                        ${stars}
                                                    </span>
                                                </p>
                                            </div>
                                            <div class="text-center px-2"
                                            style="height: 5rem;
                                                overflow: auto;
                                                display: flex;
                                                align-items: center;
                                                width: 17.5rem;
                                                justify-content: center;
                                                padding-block: 0.5rem;
                                                background: #fafafa;
                                                border-radius: 0.5rem;">
                                                ${review.msg}
                                            </div>
                                            <div class="card-body d-flex justify-content-between align-items-center" style="width:100%;">
                                                <a href="/edit-review?rid=${review._id}" class="btn btn-type-1 mx-2">
                                                    Edit <i class="fa-solid fa-pen-to-square"></i>
                                                </a>
                                                <a href="/delete-review?rid=${review._id}" class="btn btn-outline-danger mx-2">
                                                    Delete <i class="fa-solid fa-trash"></i>
                                                </a>
                                            </div>
                                        </div>
                                    </div>`;
                            });
                            $(".my-reviews-div").html(html);
                        });
                    });
                });
            }

        </script>
</head>


<body>
    <%- include ('../../partials/navbar') %>
        <div class="container-fluid mx-auto mt-4 headingDiv">
            <h4 class="headings">
                My Reviews
                <hr>
            </h4>
        </div>

        <div class="container-fluid">
            <div class="row mx-auto my-reviews-div d-flex justify-content-center align-items-center"></div>
        </div>
</body>

</html>